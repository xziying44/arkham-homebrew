根据你提供的文档格式，我来编写GitHub图床接口的文档：

# GitHub图床接口文档

## 23. GitHub登录

### 基本信息

- **接口名称**: GitHub登录
- **请求地址**: `/api/github/login`
- **请求方法**: `POST`
- **功能描述**: 使用GitHub Personal Access Token登录GitHub，验证身份并获取用户信息

### 请求参数

| 参数名 | 类型   | 必填 | 说明                                           |
| ------ | ------ | ---- | ---------------------------------------------- |
| token  | string | 是   | GitHub Personal Access Token，需要repo权限    |

### 响应格式

**成功响应**
```json
{
  "code": 0,
  "msg": "GitHub登录成功",
  "data": {
    "username": "your_github_username"
  }
}
```

**失败响应**
```json
{
  "code": 10002,
  "msg": "认证失败: HTTP 401",
  "data": null
}
```

### 请求示例

```bash
curl -X POST /api/github/login \
  -H "Content-Type: application/json" \
  -d '{
    "token": "ghp_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
  }'
```

### 示例响应

**登录成功**
```json
{
  "code": 0,
  "msg": "GitHub登录成功",
  "data": {
    "username": "yourname"
  }
}
```

**Token无效**
```json
{
  "code": 10002,
  "msg": "认证失败: HTTP 401 - Bad credentials",
  "data": null
}
```

## 24. 获取GitHub仓库列表

### 基本信息

- **接口名称**: 获取GitHub仓库列表
- **请求地址**: `/api/github/repositories`
- **请求方法**: `GET`
- **功能描述**: 获取用户的所有GitHub仓库列表，支持自动静默登录

### 请求参数

无需请求参数

### 响应格式

**成功响应**
```json
{
  "code": 0,
  "msg": "获取仓库列表成功",
  "data": {
    "repositories": [
      {
        "name": "repo-name",
        "full_name": "username/repo-name",
        "private": false,
        "description": "Repository description",
        "updated_at": "2024-01-01T00:00:00Z"
      }
    ]
  }
}
```

**失败响应**
```json
{
  "code": 10004,
  "msg": "请先配置GitHub Token",
  "data": null
}
```

### 请求示例

```bash
curl -X GET /api/github/repositories \
  -H "Content-Type: application/json"
```

### 示例响应

**成功获取**
```json
{
  "code": 0,
  "msg": "获取仓库列表成功",
  "data": {
    "repositories": [
      {
        "name": "my-images",
        "full_name": "yourname/my-images",
        "private": false,
        "description": "Image hosting repository",
        "updated_at": "2024-01-15T10:30:00Z"
      },
      {
        "name": "private-repo",
        "full_name": "yourname/private-repo",
        "private": true,
        "description": "Private repository",
        "updated_at": "2024-01-10T15:20:00Z"
      }
    ]
  }
}
```

**未配置Token**
```json
{
  "code": 10004,
  "msg": "请先配置GitHub Token",
  "data": null
}
```

## 25. 上传图片到GitHub

### 基本信息

- **接口名称**: 上传图片到GitHub
- **请求地址**: `/api/github/upload`
- **请求方法**: `POST`
- **功能描述**: 将指定图片上传到配置的GitHub仓库中，生成唯一文件名并返回直链

### 请求参数

| 参数名     | 类型   | 必填 | 说明                                     |
| ---------- | ------ | ---- | ---------------------------------------- |
| image_path | string | 是   | 相对于工作目录的图片文件路径             |

### 响应格式

**成功响应**
```json
{
  "code": 0,
  "msg": "图片上传成功",
  "data": {
    "url": "https://raw.githubusercontent.com/username/repo/main/images/abc123.png",
    "repo": "username/repo-name",
    "branch": "main",
    "folder": "images"
  }
}
```

**失败响应**
```json
{
  "code": 10011,
  "msg": "不支持的文件格式，支持的格式: .jpg, .jpeg, .png, .gif, .bmp, .webp",
  "data": null
}
```

### 请求示例

```bash
curl -X POST /api/github/upload \
  -H "Content-Type: application/json" \
  -d '{
    "image_path": "images/test.png"
  }'
```

```bash
curl -X POST /api/github/upload \
  -H "Content-Type: application/json" \
  -d '{
    "image_path": "screenshots/demo.jpg"
  }'
```

### 示例响应

**上传成功**
```json
{
  "code": 0,
  "msg": "图片上传成功",
  "data": {
    "url": "https://raw.githubusercontent.com/yourname/my-images/main/images/a1b2c3d4e5f6.png",
    "repo": "yourname/my-images",
    "branch": "main",
    "folder": "images"
  }
}
```

**文件不存在**
```json
{
  "code": 10011,
  "msg": "图片文件不存在: images/test.png",
  "data": null
}
```

**格式不支持**
```json
{
  "code": 10011,
  "msg": "不支持的文件格式，支持的格式: .jpg, .jpeg, .png, .gif, .bmp, .webp",
  "data": null
}
```

## 26. 获取GitHub状态

### 基本信息

- **接口名称**: 获取GitHub状态
- **请求地址**: `/api/github/status`
- **请求方法**: `GET`
- **功能描述**: 获取当前GitHub连接状态、配置状态和用户信息

### 请求参数

无需请求参数

### 响应格式

**成功响应**
```json
{
  "code": 0,
  "msg": "获取GitHub状态成功",
  "data": {
    "status": {
      "is_logged_in": true,
      "username": "your_username",
      "has_config": true,
      "last_error": ""
    }
  }
}
```

**失败响应**
```json
{
  "code": 10013,
  "msg": "获取GitHub状态失败: 系统错误",
  "data": null
}
```

### 请求示例

```bash
curl -X GET /api/github/status \
  -H "Content-Type: application/json"
```

### 示例响应

**已登录状态**
```json
{
  "code": 0,
  "msg": "获取GitHub状态成功",
  "data": {
    "status": {
      "is_logged_in": true,
      "username": "yourname",
      "has_config": true,
      "last_error": ""
    }
  }
}
```

**未登录状态**
```json
{
  "code": 0,
  "msg": "获取GitHub状态成功",
  "data": {
    "status": {
      "is_logged_in": false,
      "username": null,
      "has_config": false,
      "last_error": "请先配置GitHub Token"
    }
  }
}
```

## 配置说明

GitHub图床功能需要在配置项中设置以下参数：

| 配置项         | 类型   | 必填 | 默认值 | 说明                                    |
| -------------- | ------ | ---- | ------ | --------------------------------------- |
| github_token   | string | 是   | ""     | GitHub Personal Access Token           |
| github_repo    | string | 是   | ""     | 目标仓库名称（格式：username/repo-name） |
| github_branch  | string | 否   | main   | 目标分支名称                            |
| github_folder  | string | 否   | images | 存储文件夹名称                          |

### 配置示例

在配置页面中设置：

```json
{
  "github_token": "ghp_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",
  "github_repo": "yourname/my-images",
  "github_branch": "main",
  "github_folder": "images"
}
```

## GitHub Token 申请步骤

1. 登录GitHub账户
2. 进入 Settings → Developer settings → Personal access tokens → Tokens (classic)
3. 点击 "Generate new token (classic)"
4. 设置Token名称和过期时间
5. 勾选 "repo" 权限（包含所有子权限）
6. 点击生成并复制Token

## 支持的图片格式

| 格式   | 扩展名             | 说明           |
| ------ | ------------------ | -------------- |
| JPEG   | .jpg, .jpeg        | 有损压缩格式   |
| PNG    | .png               | 无损压缩格式   |
| GIF    | .gif               | 支持动画       |
| BMP    | .bmp               | 位图格式       |
| WebP   | .webp              | 现代图片格式   |

## 错误码说明

### GitHub相关错误码 (10001-10099)

| 错误码 | 说明                                   |
| ------ | -------------------------------------- |
| 10001  | 请提供GitHub Token                     |
| 10002  | GitHub登录失败，请检查Token            |
| 10003  | GitHub登录失败（系统错误）             |
| 10004  | 请先配置GitHub Token                   |
| 10005  | 获取仓库列表失败                       |
| 10006  | 获取仓库列表失败（系统错误）           |
| 10007  | 请提供图片路径                         |
| 10008  | 获取GitHub实例失败                     |
| 10009  | 请先在配置中设置GitHub仓库             |
| 10010  | 图片路径无效                           |
| 10011  | 图片上传失败（文件或格式错误）         |
| 10012  | 上传图片失败（系统错误）               |
| 10013  | 获取GitHub状态失败（系统错误）         |

## 使用流程

1. **配置GitHub信息**
   - 在配置页面设置GitHub Token和仓库信息
 
2. **登录验证（可选）**
   - 调用登录接口验证Token有效性
   - 系统会在需要时自动静默登录

3. **查看仓库列表（可选）**
   - 获取所有可用的仓库列表
   - 用于选择目标仓库

4. **上传图片**
   - 提供图片相对路径
   - 系统自动上传并返回直链

## 注意事项

1. **Token权限**: GitHub Token需要包含 `repo` 权限才能上传文件
2. **仓库存在性**: 确保配置的仓库存在且有写入权限
3. **文件大小限制**: GitHub对单个文件有100MB的限制
4. **路径安全**: 所有文件路径都会验证是否在工作目录内
5. **唯一文件名**: 系统会自动生成UUID文件名避免冲突
6. **网络连接**: 需要稳定的网络连接访问GitHub API
7. **配置持久化**: GitHub配置保存在全局配置中，跨工作空间共享